<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #ffffff);
            --text-color: var(--tg-theme-text-color, #000000);
            --hint-color: var(--tg-theme-hint-color, #999999);
            --button-color: var(--tg-theme-button-color, #2481cc);
            --button-text-color: var(--tg-theme-button-text-color, #ffffff);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f0f0f0);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        /* --- –≠–∫—Ä–∞–Ω—ã --- */
        .screen {
            display: none;
            padding: 20px;
            padding-bottom: 80px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è —Ç–∞–±–±–∞—Ä–∞ */
        }
        .screen.active {
            display: block;
        }

        /* --- –¢–∞–±–±–∞—Ä (–ú–µ–Ω—é –≤–Ω–∏–∑—É) --- */
        .tabbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background-color: var(--bg-color);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid var(--hint-color);
            z-index: 100;
        }

        .tab-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            color: var(--hint-color);
            font-size: 12px;
        }

        .tab-item.active {
            color: var(--button-color);
            font-weight: bold;
        }

        .tab-icon {
            font-size: 24px;
            display: block;
            margin-bottom: 4px;
        }

        /* --- –°—Ç–∏–ª–∏ –õ–∏–¥–µ—Ä–±–æ—Ä–¥–∞ --- */
        .leaderboard-header {
            background-color: var(--secondary-bg);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
            border: 1px solid var(--hint-color);
        }
        .leaderboard-header h2 {
            margin: 0;
            font-size: 18px;
        }
        .user-rank-info {
            color: var(--button-color);
            font-weight: bold;
            font-size: 16px;
            margin-top: 5px;
        }

        .leader-card {
            display: flex;
            align-items: center;
            background-color: var(--bg-color);
            padding: 12px 0;
            border-bottom: 1px solid var(--secondary-bg);
        }

        .rank-num {
            width: 40px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
        }

        .leader-info {
            flex-grow: 1;
            padding-left: 10px;
        }

        .leader-name {
            font-weight: bold;
            font-size: 16px;
        }

        .leader-school {
            font-size: 13px;
            color: var(--text-color);
            opacity: 0.8;
        }

        .leader-region {
            font-size: 11px;
            color: var(--hint-color);
        }

        .leader-score {
            font-weight: bold;
            color: var(--button-color);
            font-size: 16px;
            min-width: 60px;
            text-align: right;
            padding-right: 10px;
        }

        /* --- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ --- */
        #registration-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-color);
            z-index: 1000;
            padding: 20px;
            display: flex; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —á–µ—Ä–µ–∑ JS, –ø–æ–∫–∞–∂–µ–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ */
            flex-direction: column;
            justify-content: center;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--hint-color);
            font-size: 14px;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--hint-color);
            border-radius: 8px;
            background: var(--secondary-bg);
            color: var(--text-color);
            box-sizing: border-box; /* –í–∞–∂–Ω–æ –¥–ª—è —à–∏—Ä–∏–Ω—ã */
        }
        
        .main-btn {
            background-color: var(--button-color);
            color: var(--button-text-color);
            border: none;
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .hidden { display: none !important; }
        .loading { text-align: center; color: var(--hint-color); margin-top: 20px; }
    </style>
</head>
<body>

    <div id="registration-modal" class="hidden">
        <h2 style="text-align: center;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
        <p style="text-align: center; color: var(--hint-color);">–î–ª—è —É—á–∞—Å—Ç–∏—è –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É.</p>
        
        <div class="form-group">
            <label>–í–∞—à–µ –ò–º—è –∏ –§–∞–º–∏–ª–∏—è</label>
            <input type="text" id="reg-name" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
        </div>

        <div class="form-group">
            <label>–†–µ–≥–∏–æ–Ω</label>
            <input type="text" id="reg-region" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢–∞—à–∫–µ–Ω—Ç">
        </div>

        <div class="form-group">
            <label>–†–∞–π–æ–Ω</label>
            <input type="text" id="reg-district" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ß–∏–ª–∞–Ω–∑–∞—Ä—Å–∫–∏–π">
        </div>

        <div class="form-group">
            <label>–®–∫–æ–ª–∞</label>
            <input type="text" id="reg-school" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –®–∫–æ–ª–∞ ‚Ññ1">
        </div>

        <div class="form-group">
            <label>–ö–ª–∞—Å—Å</label>
            <input type="text" id="reg-class" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 9–ë">
        </div>

        <button class="main-btn" onclick="submitRegistration()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤–æ–π—Ç–∏</button>
        <p id="reg-error" style="color: red; text-align: center; display: none;">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!</p>
    </div>

    <div id="home-screen" class="screen active">
        <h1>–¢–µ—Å—Ç—ã</h1>
        <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç —Ç—É—Ä—ã...</p>
        </div>

    <div id="leaderboard-screen" class="screen">
        <div class="leaderboard-header">
            <h2>üèÜ –¢–∞–±–ª–∏—Ü–∞ –õ–∏–¥–µ—Ä–æ–≤</h2>
            <div id="user-rank-display" class="user-rank-info">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>

        <div id="leaderboard-list">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
        </div>
    </div>

    <div class="tabbar" id="main-tabbar">
        <div class="tab-item active" onclick="openTab('home')">
            <span class="tab-icon">üè†</span>
            –ì–ª–∞–≤–Ω–∞—è
        </div>
        <div class="tab-item" onclick="openTab('leaderboard')">
            <span class="tab-icon">üìä</span>
            –†–µ–π—Ç–∏–Ω–≥
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
